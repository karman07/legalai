# LegalPadhai Authentication Architecture

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND (React)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     UI Layer                             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  Auth.tsx     â”‚  â”‚ Dashboard    â”‚  â”‚ Other Pages  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ (Login/Signup)â”‚  â”‚              â”‚  â”‚              â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚          â”‚                  â”‚                 â”‚          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚             â”‚                  â”‚                 â”‚              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                 Context Layer                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚          AuthContext.tsx                           â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ user: UserProfile | null                        â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ loading: boolean                                â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ signUp(email, password, ...)                    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ signIn(email, password)                         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ googleSignIn(idToken)                           â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ signOut()                                       â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ refreshProfile()                                â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                      â”‚                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                 Service Layer                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚          authService.ts                            â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ register(data) â†’ RegisterResponse               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ login(data) â†’ AuthResponse                      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ googleSignIn(data) â†’ AuthResponse               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ getProfile() â†’ UserProfile                      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ saveToken(token)                                â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ removeToken()                                   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ isAuthenticated()                               â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                      â”‚                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚          api.ts (API Client)                       â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ apiClient<T>(endpoint, options)                 â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Auto-inject Authorization header               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Error handling                                  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Base URL from VITE_API_URL                      â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                      â”‚                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              localStorage                                â”‚   â”‚
â”‚  â”‚  â€¢ accessToken: "eyJhbGciOiJIUzI1NiIsInR5cCI..."      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ HTTP Requests
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND (Node.js + NestJS)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  POST /api/auth/register     â†’ Create user (no token)            â”‚
â”‚  POST /api/auth/login        â†’ Return JWT + user                 â”‚
â”‚  POST /api/auth/google-signin â†’ Verify Firebase + return JWT     â”‚
â”‚  GET  /api/auth/profile      â†’ Return user profile (auth req)    â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Authentication Flows

### Registration Flow
```
User
  â”‚
  â”œâ”€â”€> Fill signup form (name, email, password, type)
  â”‚
  â”œâ”€â”€> Click "Create Account"
  â”‚
  â”œâ”€â”€> Auth.tsx
  â”‚      â”‚
  â”‚      â””â”€â”€> AuthContext.signUp()
  â”‚             â”‚
  â”‚             â””â”€â”€> authService.register()
  â”‚                    â”‚
  â”‚                    â””â”€â”€> POST /api/auth/register
  â”‚                           â”‚
  â”‚                           â”œâ”€â”€> Backend creates user
  â”‚                           â”‚
  â”‚                           â””â”€â”€> Return { message, userId, email }
  â”‚
  â”œâ”€â”€> Show success: "Registration successful. You can now login."
  â”‚
  â””â”€â”€> Auto-switch to Login view
       â”‚
       â””â”€â”€> User enters credentials â†’ Login Flow
```

### Login Flow
```
User
  â”‚
  â”œâ”€â”€> Enter email & password
  â”‚
  â”œâ”€â”€> Click "Login"
  â”‚
  â”œâ”€â”€> Auth.tsx
  â”‚      â”‚
  â”‚      â””â”€â”€> AuthContext.signIn()
  â”‚             â”‚
  â”‚             â””â”€â”€> authService.login()
  â”‚                    â”‚
  â”‚                    â””â”€â”€> POST /api/auth/login
  â”‚                           â”‚
  â”‚                           â””â”€â”€> Backend validates
  â”‚                                  â”‚
  â”‚                                  â””â”€â”€> Return { accessToken, user }
  â”‚
  â”œâ”€â”€> authService.saveToken(accessToken)
  â”‚      â”‚
  â”‚      â””â”€â”€> localStorage.setItem('accessToken', token)
  â”‚
  â”œâ”€â”€> AuthContext.setUser(user)
  â”‚
  â””â”€â”€> navigate('/dashboard')
```

### Auto-Login on Page Refresh
```
App Loads
  â”‚
  â”œâ”€â”€> AuthContext useEffect() runs
  â”‚      â”‚
  â”‚      â””â”€â”€> authService.isAuthenticated()
  â”‚             â”‚
  â”‚             â”œâ”€â”€> Check: localStorage.getItem('accessToken')
  â”‚             â”‚
  â”‚             â””â”€â”€> If token exists:
  â”‚                    â”‚
  â”‚                    â””â”€â”€> authService.getProfile()
  â”‚                           â”‚
  â”‚                           â””â”€â”€> GET /api/auth/profile
  â”‚                                  â”‚   (with Authorization header)
  â”‚                                  â”‚
  â”‚                                  â””â”€â”€> Return UserProfile
  â”‚
  â”œâ”€â”€> AuthContext.setUser(profile)
  â”‚
  â””â”€â”€> User stays logged in âœ…
```

### Google Sign-In Flow
```
User
  â”‚
  â”œâ”€â”€> Click "Sign in with Google"
  â”‚
  â”œâ”€â”€> Firebase Popup Opens
  â”‚      â”‚
  â”‚      â””â”€â”€> User selects Google account
  â”‚             â”‚
  â”‚             â””â”€â”€> Firebase returns ID token
  â”‚
  â”œâ”€â”€> AuthContext.googleSignIn(idToken)
  â”‚      â”‚
  â”‚      â””â”€â”€> authService.googleSignIn({ idToken })
  â”‚             â”‚
  â”‚             â””â”€â”€> POST /api/auth/google-signin
  â”‚                    â”‚
  â”‚                    â””â”€â”€> Backend verifies with Firebase
  â”‚                           â”‚
  â”‚                           â”œâ”€â”€> Create/Find user
  â”‚                           â”‚
  â”‚                           â””â”€â”€> Return { accessToken, user }
  â”‚
  â”œâ”€â”€> authService.saveToken(accessToken)
  â”‚
  â”œâ”€â”€> AuthContext.setUser(user)
  â”‚
  â””â”€â”€> navigate('/dashboard')
```

### Logout Flow
```
User
  â”‚
  â”œâ”€â”€> Click "Logout"
  â”‚
  â”œâ”€â”€> AuthContext.signOut()
  â”‚      â”‚
  â”‚      â””â”€â”€> authService.removeToken()
  â”‚             â”‚
  â”‚             â””â”€â”€> localStorage.removeItem('accessToken')
  â”‚
  â”œâ”€â”€> AuthContext.setUser(null)
  â”‚
  â””â”€â”€> Redirect to /auth
```

## ğŸ“¦ Data Flow

### Request Flow (Protected Endpoint)
```
Component
  â”‚
  â””â”€â”€> authService.getProfile()
         â”‚
         â””â”€â”€> apiClient('/auth/profile')
                â”‚
                â”œâ”€â”€> Get token: localStorage.getItem('accessToken')
                â”‚
                â”œâ”€â”€> Add header: { Authorization: `Bearer ${token}` }
                â”‚
                â””â”€â”€> fetch(`${API_BASE_URL}/auth/profile`, { headers })
                       â”‚
                       â””â”€â”€> Backend validates JWT
                              â”‚
                              â”œâ”€â”€> Valid? â†’ Return data
                              â”‚
                              â””â”€â”€> Invalid? â†’ 401 Unauthorized
```

### Error Flow
```
API Error
  â”‚
  â”œâ”€â”€> apiClient catches error
  â”‚      â”‚
  â”‚      â””â”€â”€> Throws Error with message from backend
  â”‚
  â”œâ”€â”€> authService catches error
  â”‚      â”‚
  â”‚      â””â”€â”€> Throws Error
  â”‚
  â”œâ”€â”€> AuthContext catches error
  â”‚      â”‚
  â”‚      â””â”€â”€> Logs error
  â”‚             â”‚
  â”‚             â””â”€â”€> Throws Error
  â”‚
  â””â”€â”€> Component catches error
         â”‚
         â””â”€â”€> Display error message to user
```

## ğŸ—‚ï¸ File Structure
```
src/
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ api.ts                    # Base HTTP client
â”‚   â””â”€â”€ authService.ts            # Auth methods
â”‚
â”œâ”€â”€ contexts/
â”‚   â””â”€â”€ AuthContext.tsx           # Global auth state
â”‚
â”œâ”€â”€ components/
â”‚   â””â”€â”€ Auth.tsx                  # Login/Signup UI
â”‚
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ DashboardPage.tsx         # Protected route
â”‚   â””â”€â”€ ...                       # Other pages
â”‚
â”œâ”€â”€ examples/
â”‚   â””â”€â”€ GoogleAuthExample.tsx    # Firebase integration
â”‚
â””â”€â”€ App.tsx                       # Router setup
```

## ğŸ” Security Model

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           User Browser               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  localStorage                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ accessToken:                   â”‚ â”‚
â”‚  â”‚ "eyJhbGciOiJIUzI1NiIsInR5..."â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â†‘                 â”‚          â”‚
â”‚         â”‚ Save            â”‚ Read     â”‚
â”‚         â”‚                 â†“          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚      authService.ts            â”‚ â”‚
â”‚  â”‚  â€¢ saveToken()                 â”‚ â”‚
â”‚  â”‚  â€¢ getToken()                  â”‚ â”‚
â”‚  â”‚  â€¢ removeToken()               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                 â”‚                    â”‚
â”‚                 â”‚ Add to headers     â”‚
â”‚                 â†“                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Authorization: Bearer token   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                 â”‚                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â”œâ”€â”€> HTTPS
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Backend Server              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  JWT Middleware                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 1. Extract token from header   â”‚ â”‚
â”‚  â”‚ 2. Verify signature            â”‚ â”‚
â”‚  â”‚ 3. Check expiration (7 days)   â”‚ â”‚
â”‚  â”‚ 4. Decode user ID              â”‚ â”‚
â”‚  â”‚ 5. Attach user to request      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                 â”‚                    â”‚
â”‚                 â”œâ”€â”€> Valid â†’ Continueâ”‚
â”‚                 â”‚                    â”‚
â”‚                 â””â”€â”€> Invalid â†’ 401   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š State Management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         App Component Tree          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  <AuthProvider>                     â”‚
â”‚    â”œâ”€â”€ user: UserProfile | null     â”‚
â”‚    â”œâ”€â”€ loading: boolean             â”‚
â”‚    â””â”€â”€ methods: { ... }             â”‚
â”‚       â”‚                             â”‚
â”‚       â”œâ”€> <App>                     â”‚
â”‚       â”‚    â”œâ”€> <LandingPage>        â”‚
â”‚       â”‚    â”œâ”€> <Auth>               â”‚
â”‚       â”‚    â””â”€> <Dashboard>          â”‚
â”‚       â”‚         â”œâ”€> <Notes>         â”‚
â”‚       â”‚         â”œâ”€> <MCQ>           â”‚
â”‚       â”‚         â””â”€> <Chatbot>       â”‚
â”‚       â”‚                             â”‚
â”‚       â””â”€> All can access:           â”‚
â”‚           â€¢ user state              â”‚
â”‚           â€¢ signIn()                â”‚
â”‚           â€¢ signOut()               â”‚
â”‚           â€¢ etc.                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**This architecture ensures:**
âœ… Secure token management
âœ… Centralized authentication state
âœ… Reusable API client
âœ… Type-safe requests/responses
âœ… Auto-login on refresh
âœ… Easy error handling
